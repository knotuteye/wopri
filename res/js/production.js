const homeWindow=document.getElementById("home"),gameWindow=document.getElementById("game-window"),gameOverWindow=document.getElementById("game-over"),questionHolder=document.getElementById("question-holder"),questionText=document.getElementById("question"),answerBoxes=document.getElementsByClassName("answer-holder"),finalScorePct=document.getElementById("final-score"),qNumberText=document.getElementById("qn-number").children[0];let AMOUNT=15,DIFFICULTY="",TYPE="multiple",CATEGORY="",ANSWER="",QNUMBER=0,QN_ARRAY=[];const startGame=()=>{navigator.serviceWorker&&navigator.serviceWorker.register("/wopri/service-worker.js",{scope:"/wopri/"}),gameWindow.hidden=!0,animateStartGame(),fetchQuestion();for(let e=0;e<answerBoxes.length;e++)answerBoxes[e].addEventListener("click",keepScore)},animateStartGame=()=>{homeWindow.classList.add("flipOutY"),setTimeout(()=>{setTimeout(()=>{homeWindow.hidden=!0},300)},300)},fetchQuestion=()=>{fetch(`https://opentdb.com/api.php?amount=${AMOUNT}&difficulty=${DIFFICULTY}&type=${TYPE}&category=${CATEGORY}`).then(e=>e.json()).then(e=>QN_ARRAY=e.results).then(e=>getNextQuestion(e[QNUMBER])).catch(e=>onDeviceOffline())},getNextQuestion=e=>{ANSWER=decodeHTMLString(e.correct_answer),questionText.innerText=decodeHTMLString(e.question),answerBoxes[0].children[1].innerText=decodeHTMLString(e.correct_answer);for(let t=0;t<e.incorrect_answers.length;t++)answerBoxes[t+1].children[1].innerText=decodeHTMLString(e.incorrect_answers[t]);qNumberText.innerText=++QNUMBER,gameWindow.style.display="block"},keepScore=e=>{let t=e.target.querySelector(".answer-holder label")||e.target.closest(".answer-holder label")||e.target.nextSibling.nextSibling;t.innerText==ANSWER?animateAll(t,!0):animateAll(t,!1)},animateAll=(e,t)=>{animateAnswerHolder(e.closest(".answer-holder"),t),animateQuestionHolder(t)},gameOver=()=>{finalScorePct.innerText=`${(100*(QNUMBER-1)/15).toFixed(0)}%`,gameWindow.classList.replace("flipInY","slideOutUp"),setTimeout(()=>{gameWindow.style.display="none",console.log(gameWindow.classList)},600),gameOverWindow.style.display="block"},animateQuestionHolder=e=>{e&&(questionHolder.classList.add("fadeOut"),setTimeout(()=>{questionHolder.classList.replace("fadeOut","fadeIn")},600),questionHolder.classList.remove("fadeIn"))},animateAnswerHolder=(e,t)=>{e.classList.add(t?"correct":"wrong"),setTimeout(()=>{e.classList.remove(t?"correct":"wrong")},500),setTimeout(()=>{t?getNextQuestion(QN_ARRAY[QNUMBER]):(finalScorePct.innerText=`${(100*(QNUMBER-1)/15).toFixed(0)}%`,gameWindow.classList.replace("flipInY","slideOutUp"),setTimeout(()=>{gameWindow.style.display="none",console.log(gameWindow.classList)},600),gameOverWindow.style.display="block")},600)},decodeHTMLString=e=>{let t=document.createElement("textarea");return t.innerHTML=e,t.innerText},onDeviceOffline=()=>{alert("Device Offline")};