const homeWindow=document.getElementById("home"),gameWindow=document.getElementById("game-window"),gameOverWindow=document.getElementById("game-over"),questionHolder=document.getElementById("question-holder"),questionText=document.getElementById("question"),answerBoxes=document.getElementsByClassName("answer-holder"),finalScorePct=document.getElementById("final-score"),qNumberText=document.getElementById("qn-number").children[0];let CATEGORIES=[17,18,19,30,23,20,27],DIFFICULTIES=["easy","easy","easy","medium","hard"],ANSWER="",QNUMBER=0,QN_ARRAY=[];const startGame=()=>{gameWindow.hidden=!0,animateStartGame(),fetchQuestion();for(let e=0;e<answerBoxes.length;e++)answerBoxes[e].addEventListener("click",keepScore)},animateStartGame=()=>{homeWindow.classList.add("flipOutY"),setTimeout(()=>{setTimeout(()=>{homeWindow.hidden=!0},300)},300)},generateQuestionSeed=()=>{let e=[];for(;e.length<15;){let t;t=e.length<5?DIFFICULTIES[0]:e.length<10?DIFFICULTIES[1]:DIFFICULTIES[2];let n=CATEGORIES[(Math.random()*CATEGORIES.length-1).toFixed(0)]||CATEGORIES[0];e.push({category:n,difficulty:t})}return e},fetchQuestion=()=>{Promise.all(generateQuestionSeed().map(e=>{let t=`https://opentdb.com/api.php?amount=1&difficulty=${e.difficulty}&type=multiple&category=${e.category}`;return fetch(t).then(e=>e.json()).then(e=>{QN_ARRAY.push(e.results[0])})})).then(()=>{renderNextQuestion(QN_ARRAY[QNUMBER])}).catch(e=>onDeviceOffline(e))},renderNextQuestion=e=>{let t=[],n=(3*Math.random()).toFixed(0);for(t.push(n);t.length<4;){for(n=(3*Math.random()).toFixed(0);t.includes(n);)n=(3*Math.random()).toFixed(0);t.push(n)}ANSWER=decodeHTMLString(e.correct_answer);let o=[e.correct_answer,...e.incorrect_answers].map(e=>decodeHTMLString(e)),r=t.length;for(;r-- >0;)answerBoxes[r].querySelector("label").innerText=o[t[r]];console.log(e.correct_answer),questionText.innerText=decodeHTMLString(e.question),qNumberText.innerText=++QNUMBER,gameWindow.style.display="block"},keepScore=e=>{let t=e.target.querySelector(".answer-holder label")||e.target.closest(".answer-holder label")||e.target.nextSibling.nextSibling;t.innerText==ANSWER?animateAll(t,!0):animateAll(t,!1)},animateAll=(e,t)=>{animateAnswerHolder(e.closest(".answer-holder"),t),animateQuestionHolder(t)},gameOver=e=>{if(e)return console.log("lol");finalScorePct.innerText=`${(100*(QNUMBER-1)/15).toFixed(0)}%`,gameWindow.classList.replace("flipInY","slideOutUp"),setTimeout(()=>{gameWindow.style.display="none"},600),gameOverWindow.style.display="block"},animateQuestionHolder=e=>{e&&(questionHolder.classList.add("fadeOut"),setTimeout(()=>{questionHolder.classList.replace("fadeOut","fadeIn")},600),questionHolder.classList.remove("fadeIn"))},animateAnswerHolder=(e,t)=>{e.classList.add(t?"correct":"wrong"),setTimeout(()=>{e.classList.remove(t?"correct":"wrong")},500),setTimeout(()=>{15==QNUMBER&&gameOver(!0),t?renderNextQuestion(QN_ARRAY[QNUMBER]):gameOver()},600)},decodeHTMLString=e=>{let t=document.createElement("textarea");return t.innerHTML=e,t.innerText},onDeviceOffline=e=>{console.error(e)};